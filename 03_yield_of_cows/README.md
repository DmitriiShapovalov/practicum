# Увеличение стада коров

[ipynb](yield_of_cows.ipynb)

## Задачи
Создание двух линейных прогнозных моделей для отбора бурёнок в поголовье:
- первая будет прогнозировать возможный удой коровы (целевой признак Удой);
- вторая — рассчитывать вероятность получить вкусное молоко от коровы (целевой признак Вкус молока)

## Описание работы
Фермер хочет купить бурёнок, чтобы расширить поголовье стада коров, купив их у ассоциации пастбищ. Он определяет качество молока по строгой методике. Фермер хочет, чтобы каждая бурёнка давала не менее 6000 килограммов молока в год, а её надой был вкусным — строго по его критериям, ничуть не хуже. Он просит разработать модель машинного обучения, которая поможет ему управлять рисками и принимать объективное решение о покупке.

При помощи моделей нужно отобрать коров по двум критериям:
- средний удой за год — не менее 6000 килограммов;
- молоко должно быть вкусным:

## Описание данных
Исследуемый данные состоят из трех датасетов со следующей информацией:
- датасет, содержащий данные о стаде фермера на текущий момент, включающий информацию о коровах и характеристиках получаемого молока. Содержит целевые признаки величины удоя и вкуса молока.
- датасет, содержащий сведения об имени папы каждой коровы в стаде фермера
- датасет с данными коров, которые предлагаются к покупке

## План работы
- чтение и предобработка данных для выявления и исправления возможных некорректных значений
- исследовательский анализ данных, изучение входных признаки и описание полученных графиков и возможных аномалий
- корреляционный анализ признаков
- построение нескольких моделей линейной регрессии, выбрав лучшую из них, для дальнейшего отбора потенциальных коров по критерию объема среднего удоя в год - не менее 6000 килограммов
- построение модели логистической регрессии, определить коров с потенциально вкусным молоком
- тезисно сформулировать основные выводы, полученные в результате исследования

## Используемыые метрики
R2, MAE, RMSE, accuracy, precision, recall

## Используемые библиотеки
*pandas, numpy, scipy, seaborn, matplotlib, sklearn, phik* 

## Выводы
Анализ данных фермерских и покупных коров показал следующие ключевые моменты:
- на ферме преобладают коровы породы Вис Бик Айдиал, а у покупных Рефлешн Соверинг
- 82,5% фермерских коров и 75% покупных старше 2 лет
- средний удой коров: 6130 кг
- присутсвует сильная связь между удоем и возрастом, ЭКЕ и СПО
  
На этапе построения моделей:
- было построено 3 модели линейной регрессии для прогнозирования удоя молока на разных наборах признаков для получения коров возможным удоем больше 6000 с учетом доверительного интервала. У лучшей модели итоговая метрика R2 получилась 0.825
- при построении модели логистической регрессии для определения вкуса молока был изменен порог классификации для уменьшения рисков возможного приобретения невкусного молока. Было рекомендовано 3 коровы. У всех рекомендованных коров прогнозный удой с учетом доверительного интервала составил более 6000.
  
*Практические выводы:*
- коровы старше 2 лет дают удой более 5600 кг
- удой более 6900 кг дают только коровы с холмистых пастбищ
- для вкусного молока важен показатель СПО (0,93-0,94)