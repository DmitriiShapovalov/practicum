# Стоимость автомобилей

[ipynb](the_cost_of_cars.ipynb)

## Задача
Построение модели для определения стоимости автомобиля.

## Описание проекта
Сервис по продаже автомобилей с пробегом разрабатывает приложение для привлечения новых клиентов. В нём можно быстро узнать рыночную стоимость своего автомобиля.
Заказчику важны следующие критерии:
- качество предсказания;
- скорость предсказания;
- время обучения.

## Описание данных
Исследуемые данные состоят из одного датасета с информацией о характеристиках продаваемого автомобиля и технической информации о пользователе, который загрузил объявление 

## План работы
- чтение и предобработка полученных данных для проверки на соответствие данных описанию, выявление и исправление некорректных аномальных значений
- проведение исследовательского анализа данных для изучения входных признаков и выявления аномалий и выбросов
- проведение корреляционного анализа входных признаков,проверка их на мультиколлинеарность и при необходимости удаление наименее важных признаков
- подготовка с помощью пайплайна данных для моделирования, используя кодировщики и скейлеры
- обучение сразу нескольких моделей: ближайших соседей, дерева решений и моделей бустинга, подобрав к ним лучшие гиперпараметры
- оценивать  модели будем метрикой RMSE
- анализ времени обучения, времени предсказаний и качества моделей
- основываясь на нижеперечисленных критериях заказчика, выбор лучшей модели, проверка её качества на тестовой выборке.

## Используемые метрики
*RMSE*

## Используемые библиотеки
*catboost, lightgbm, phik, sklearn, pandas, numpy, re, matplotlib, seaborn, re, os, requests*

## Выводы
- На этапе предобработки данных убраны аномалии, явные  и неявные дубликаты, также для дальнейшего обучения убраны неинформативные столбцы.
- Анализ данных показал, что большинство автомобилей относится к сегменту бюджетных (1000-1500 евро), с преобладанием седанов (26.1%), механической КПП (76.2%) и бензиновых двигателей (89.9%). Лидером среди марок оказался Volkswagen - 21.7% от общего количества автомобилей.
- Корреляциоонный анализ выявил сильную связь между целевым признаком и годом регистрации, моделью и мощностью автомобиля.
- Модели DecisionTreeRegressor() и KNeighborsRegressor() обучены в пайплайне с автоматизированным подбором гиперпараметров при помощи RandomizedSearchCV(), а модели CatBoostRegressor() и LGBMRegressor() обучены в пайплайне с применением GridSearchCV().
- Лучшей моделью по совокупной оценке критериев выбора оказалась CatBoostRegressor() со стандартным набором гиперпараметров и итоговой метрикой RMSE при тестировании 1702.98.