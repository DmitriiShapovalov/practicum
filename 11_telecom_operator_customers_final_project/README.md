# Клиенты оператора связи

[ipynb](telecom_operator_customers_final_project.ipynb)

## Задача
Получение модели с заданной итоговой точностью, которая будет предсказывать вероятность того, разорвёт ли абонент договор.

## Описание проекта
Оператор связи хочет бороться с оттоком клиентов. Для этого его сотрудники начнут предлагать промокоды и специальные условия всем, кто планирует отказаться от услуг связи. Чтобы заранее находить таких пользователей, компании нужна модель, которая будет предсказывать, разорвёт ли абонент договор. Оператор предоставляет два основных типа услуг: cтационарную телефонную связь и интернет. Также доступны дополнительные услуги для подключения. Клиенты могут платить за услуги каждый месяц или заключить договор на 1–2 года. Возможно оплатить счёт разными способами, а также получить электронный чек. Информация о договорах актуальна на 1 февраля 2020 года.

## План работы
- чтение и предобработка полученных данных для проверки на соответствие данных описанию:
  - изменение типов данных при необходимости
  - переименование столбцов
  - выявление и исправление пропущенных и некорректных значений
  - обработка явных и неявных дубликатов
- добавление при необходимости новых признаков 
- объединение всех датафреймов в один общий
- проведение исследовательского анализа данных для изучения входных признаков и выявления возможных аномалий и выбросов
- проведение корреляционного анализа входных признаков,проверка их на мультиколлинеарность и при необходимости удаление наименее важных признаков
- подготовка данных для моделирования, используя кодировщики и скейлеры. При объемной подготовке данных применим пайплайн
- обучение сразу нескольких моделей, подбирая к ним лучшие гиперпараметры автоматизированным способом 
- анализ времени обучения, времени предсказаний и качества моделей
- выбор лучшей модели, проверка её качества на тестовой выборке и анализ результатов и важности  признаков. Для оценивания моделей будем применять метрику ROC-AUC, на тестовой выборке итоговая метрика должна быть не ниже 0.85
- рекомендации заказчику и итоговые выводы

## Описание данных
Исследуемые данные состоят из нескольких датасетов:
- датасет с информацией о договоре
- датасет с персональными данными клиента
- датасет с информацией об интернет-услугах
- датасет с информацией об услугах телефонии
 
## Используемые метрики
roc-auc, accuracy

## Используемые библиотеки
*pandas, numpy, matplotlib, seaborn, os, re, requests, phik, sklearn, catboost, lightgbm, shap*

## Итоговые выводы
- на этапе предобработки данных убраны неявные пропуски и  некорректные значения, удалены явные и неявные дубликаты, изменены типы столбцов и наименования
- На основании исследовательского и корреляционного анализа из датасета были отобраны нужные признаки для обучения моделей и убраны ненужные 
- Для улучшения качества моделей созданы новые признаки 
- В пайплайнах было обучено несколько моделей: LogisticRegression(), SVC(), DecisionTreeClassifier() и KNeighborsClassifier() и CatBoostClassifier(). Ко всем были подобраны гиперпараметры автоматизированным методом при помощи GridSearchCV() и RandomizedSearchCV().
- Из всех рассматриваемых моделей лучшей оказалась CatBoostClassifier(), на этапе тестирования показала итоговые метрики ROC-AUC = 0.923 и Accuracy = 0.933. Матрица ошибок показала, что перевеса в сторону ошибок одного из классов не наблюдается, в среднем ошибается в предсказании каждого класса на 7-8%

- По результатам  полученных графиков и анализа важности признаков модели выявлены ключевые факторы оттока клиентов:
   - длительность договора — критический период от 400 до 1700 дней, после которого вероятность ухода снижается
   - размер ежемесячного платежа — клиенты с платежами выше 80 уходят чаще
   - общая сумма платежей — при сумме более 5000 вероятность ухода минимальна
   - количество подключенных услуг — чем больше услуг, тем выше риск расторжения договора
   - социальный статус клиента - пенсионеры и клиенты в браке чаще расторгают договор

- С учетом графика пчелиного роя, составлены направленные рекомендации заказчику:
  - внедрить модель прогнозирования оттока для раннего выявления риска ухода
  - разработать программу лояльности и накопления баллов для клиентов со стажем более 1000 дней, также внедрить систему промокодов для клиентов 400-1000 дней и мониторинг удовлетворенности для клиентов от 400 до 1700 дней
  - предложить гибкие схемы оплаты для клиентов с высокими ежемесячными платежами
  - не навязывать дополнительные опции клиентам без интернета
  - создать специальные тарифы для пенсионеров и семейные предложения для клиентов в браке