# Заказы такси

[ipynb](taxi_order_forecasting.ipynb)

## Задача
Построение модели для предсказания количества заказов такси.

## Описание проекта
Собраны исторические данные о заказах такси в аэропортах. Чтобы привлекать больше водителей в период пиковой нагрузки, нужно спрогнозировать количество заказов такси на следующий час для агрегатора такси.

## Описание данных
Исследуемый датасет состоит из следующих признаков:
 - временной столбец-индекс с 10-ти минутными интервалами
 - количество заказов (целевой признак) 

## План работы
- Загрузить данные и выполнить их ресемплирование по одному часу
- Проанализировать данные
- Обучить разные модели с различными гиперпараметрами. Сделать тестовую выборку размером 10% от исходных данных.
- Проверить данные на тестовой выборке. Значение метрики *RMSE* на тестовой выборке должно быть не больше 48.
- Сделать выводы. 

## Используемые метрики
*RMSE*

## Используемые библиотеки
*phik, sklearn, catboost, lightgbm, optuna, statsmodels, pandas, numpy, matplotlib, seaborn, time, os, requests, logging, warnings*

## Выводы
- В результате анализа временного ряда заказов такси было выявлено наличие положительного тренда с марта по август, а также суточная цикличность с пиком в полночь, подтверждена стационарность временного ряда и изучены влияния лагов на целевой признак.
- На первом этапе обучения добавлены новые признаки в датасет: календарные, скользящее среднее и лаги. Обучены модели - KNeighborsRegressor(), DecisionTreeRegressor(), LinearRegressor(), CatBoostRegressor(),
LGBMRegressor() и подобраны гиперпараметры автоматизированным способом при помощи GridSearchSV() и OptunaSearchCV().
- На первом этапе моделирования лучшие результаты показала CatBoostRegressor() с метрикой RMSE при кросс-валидации 23.3
- На втором этапе обучения модель в датасет был добавлен признак с разностью временного ряда. Благодаря этому, модель LinearRegressor() с подобранными гиперпараметрами показала идеальную точность как при обучении, так и на этапе тестирования, показав итоговый прогноз без ошибочных значений.